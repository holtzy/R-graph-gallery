<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google Analytics + AdThrive -->

    <!-- AdThrive Head Tag Manual -->
    <script data-no-optimize="1" data-cfasync="false">
      (function (w, d) {
        w.adthrive = w.adthrive || {};
        w.adthrive.cmd = w.adthrive.cmd || [];
        w.adthrive.plugin = "adthrive-ads-manual";
        w.adthrive.host = "ads.adthrive.com";
        var s = d.createElement("script");
        s.async = true;
        s.referrerpolicy = "no-referrer-when-downgrade";
        s.src =
          "https://" +
          w.adthrive.host +
          "/sites/6434363fc11d8059e61106b4/ads.min.js?referrer=" +
          w.encodeURIComponent(w.location.href) +
          "&cb=" +
          (Math.floor(Math.random() * 100) + 1);
        var n = d.getElementsByTagName("script")[0];
        n.parentNode.insertBefore(s, n);
      })(window, document);
    </script>
    <!-- End of AdThrive Head Tag -->

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-79254642-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-79254642-1");
    </script>

    <!-- Google Analytics + OutboundLink + Google Adsense -->

    <meta charset="utf-8" />
    <title>
      Extended Dumbbell Plot in R with ggplot2 &#8211; the R Graph Gallery
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="In this article you will learn how to create an extended dumbbell plot in R showing an additional grouped mean and standart deviation using the ggplot2 plotting library."
    />
    <meta
      name="keywords"
      content="R,ggplot2,tidyverse,Example,Data,Dataviz,Datavisualization,Plot,Chart,Graph,Learning,Caveat,Pitfall,Mistake"
    />
    <meta name="author" content="Yan Holtz" />
    <link rel="icon" href="img/logo/R_single_small.png" />

    <!-- Control appearance when shared by social media -->
    <meta
      property="og:title"
      content="Extended Dumbbell Plot in R with ggplot2"
    />
    <meta property="og:image" content="img/overview_RGG.png" />
    <meta
      property="og:description"
      content="In this article you will learn how to create an extended dumbbell plot in R showing an additional grouped mean and standart deviation using the ggplot2 plotting library."
    />
    <meta
      property="og:url"
      content="https://www.r-graph-gallery.com/blog-post-template.html"
    />
    <meta property="og:type" content="website" />

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link
      href="vendor/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- Custom styles for this template -->
    <link href="css/agency.css" rel="stylesheet" />

    <!-- JQUERY -->
    <script src="vendor/jquery/jquery.min.js"></script>
  </head>

  <body data-spy="scroll" data-target="#myScrollspy" data-offset="1">
    <!-- THIS ALLOWS TO INSERT THE MENU THAT IS STORED IN A MENU.HTML FILE-->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav"></nav>
    <script>
      $(function () {
        $("#mainNav").load("html_chunk/menu.html");
      });
    </script>

    <!-- THIS ALLOWS TO INSERT THE MODAL OF THE MENU THAT IS STORED IN A MENU_MODAL.HTML FILE-->
    <div id="modal_menu_insertion"></div>
    <script>
      $(function () {
        $("#modal_menu_insertion").load("html_chunk/menu_modal.html");
      });
    </script>

    <!-- Header = Title in big + social media Icon + quick description -->
    <header class="masthead" style="padding-bottom: 30px">
      <div class="textlanding">
        <center><h1>Extended Dumbbell Plot in R with ggplot2</h1></center>
        <hr class="short_hr" />
        <br />
        <ul class="list-inline social-buttons">
          <li class="list-inline-item">
            <a href="https://twitter.com/R_Graph_Gallery">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://github.com/holtzy">
              <i class="fa fa-github" style="color: white"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.yan-holtz.com">
              <i class="fa fa-home"></i>
            </a>
          </li>
        </ul>
        <center>
          <p style="max-width: 600px; margin-top: 40px">
            In this article you will learn how to create an extended dumbbell
            plot in R showing an
            <strong>additional grouped mean and standart deviation</strong>
            using the <code>ggplot2</code> plotting library.
          </p>
        </center>
        <div style="text-align: center">
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="scatterplot.html"
            >Scatterplot section</a
          >
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="https://www.data-to-viz.com/graph/scatter.html"
            >Data to Viz</a
          >
        </div>
      </div>
    </header>

    <!-- THIS ALLOWS TO INSERT THE ADVERTISEMENT BANNER THAT IS STORED IN A BANNER.HTML FILE-->
    <div id="position_for_images"></div>
    <script>
      $(function () {
        $("#position_for_images").load("html_chunk/images.html");
      });
    </script>

    <!-- STYLE for chart pages but not the rest of tthe website -->
    <style>
      img {
        margin-top: 20px;
      }
    </style>

    <div class="container">
      <center>
        <img src="img/fromTheWeb/HBCU_trends_gender.png" style="width: 60%" />
      </center>
      <h1 id="about">About</h1>
      <hr />
      <p>
        This article showcases a novel approach to the dumbbell plot created by
        Tobias Stalder, a geographer and datavisualization specialist based in
        Switzerland. You can find updates on his recent work on
        <a href="https://twitter.com/toeb18">Twitter</a>,
        <a href="https://www.linkedin.com/in/tobias-stalder-9a4083130/"
          >LinkedIn</a
        >
        and <a href="https://github.com/toebR/">github</a>.
      </p>
      <p>
        Note that you can find the original R script in
        <a
          href="https://github.com/toebR/Tidy-Tuesday/tree/master/HBCU_enrollment"
          >this TidyTuesday github repository</a
        >.
      </p>
      <p>
        Suggested citation:<br />
        Stalder, T., Holtz, Y. (2021): Extended Dumbbell Plot in R with ggplot2.
        R graph gallery. Access:
        <em>r-graph-gallery.com/web-extended-dumbbell-plot-ggplot2.html</em>.
        Date: <em>DD-MM-YYYY</em>.
      </p>
      <h1 id="libraries">Libraries</h1>
      <hr />
      <div class="sourceCode" id="cb1">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggtext)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(extrafont)</span></code></pre>
      </div>
      <p>
        The <code>extrafont</code> package is used to import additional fonts.
        If you are unfamiliar with this package, you need to run the following
        commands to load and import the fonts (Takes a while!)
      </p>
      <div class="sourceCode" id="cb2">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># font_import()  #run once</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">loadfonts</span>(<span class="dt">device =</span> <span class="st">&quot;win&quot;</span>) <span class="co">#run once per session</span></span></code></pre>
      </div>
      <h1 id="dataset">Dataset</h1>
      <hr />
      <p>
        The data for this plot was retrieved from <strong>TidyTuesday</strong>,
        a weekly datavisualisation challenge on twitter. You can read more about
        the data
        <a
          href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2021/2021-02-02/readme.md"
          >here</a
        >
        and visit
        <a href="https://github.com/rfordatascience/tidytuesday"
          >this github repository</a
        >
        to learn more about TidyTuesday. The dataset is about enrollments in
        historically black colleges and universities (HBCUs).
      </p>
      <p>You can load the data by running the following line:</p>
      <div class="sourceCode" id="cb3">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>hbcu_all &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-02-02/hbcu_all.csv&#39;</span>)</span></code></pre>
      </div>
      <p>
        Next, we will look at the data. We see a yearly resolution of
        enrollments in different categories.
      </p>
      <div class="sourceCode" id="cb4">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">head</span>(hbcu_all)</span></code></pre>
      </div>
      <div data-pagedtable="false">
        <script data-pagedtable-source type="application/json">
          {
            "columns": [
              {
                "label": ["Year"],
                "name": [1],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Total enrollment"],
                "name": [2],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Males"],
                "name": [3],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Females"],
                "name": [4],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["4-year"],
                "name": [5],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["2-year"],
                "name": [6],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Total - Public"],
                "name": [7],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["4-year - Public"],
                "name": [8],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["2-year - Public"],
                "name": [9],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Total - Private"],
                "name": [10],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["4-year - Private"],
                "name": [11],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["2-year - Private"],
                "name": [12],
                "type": ["dbl"],
                "align": ["right"]
              }
            ],
            "data": [
              {
                "1": "1976",
                "2": "222613",
                "3": "104669",
                "4": "117944",
                "5": "206676",
                "6": "15937",
                "7": "156836",
                "8": "143528",
                "9": "13308",
                "10": "65777",
                "11": "63148",
                "12": "2629"
              },
              {
                "1": "1980",
                "2": "233557",
                "3": "106387",
                "4": "127170",
                "5": "218009",
                "6": "15548",
                "7": "168217",
                "8": "155085",
                "9": "13132",
                "10": "65340",
                "11": "62924",
                "12": "2416"
              },
              {
                "1": "1982",
                "2": "228371",
                "3": "104897",
                "4": "123474",
                "5": "212017",
                "6": "16354",
                "7": "165871",
                "8": "151472",
                "9": "14399",
                "10": "62500",
                "11": "60545",
                "12": "1955"
              },
              {
                "1": "1984",
                "2": "227519",
                "3": "102823",
                "4": "124696",
                "5": "212844",
                "6": "14675",
                "7": "164116",
                "8": "151289",
                "9": "12827",
                "10": "63403",
                "11": "61555",
                "12": "1848"
              },
              {
                "1": "1986",
                "2": "223275",
                "3": "97523",
                "4": "125752",
                "5": "207231",
                "6": "16044",
                "7": "162048",
                "8": "147631",
                "9": "14417",
                "10": "61227",
                "11": "59600",
                "12": "1627"
              },
              {
                "1": "1988",
                "2": "239755",
                "3": "100561",
                "4": "139194",
                "5": "223250",
                "6": "16505",
                "7": "173672",
                "8": "158606",
                "9": "15066",
                "10": "66083",
                "11": "64644",
                "12": "1439"
              }
            ],
            "options": {
              "columns": { "min": {}, "max": [10] },
              "rows": { "min": [10], "max": [10] },
              "pages": {}
            }
          }
        </script>
      </div>
      <p>Console output:</p>
      <pre><code># A tibble: 6 x 12
   Year `Total enrollme~  Males Females `4-year` `2-year` `Total - Public`
  &lt;dbl&gt;            &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;            &lt;dbl&gt;
1  1976           222613 104669  117944   206676    15937           156836
2  1980           233557 106387  127170   218009    15548           168217
3  1982           228371 104897  123474   212017    16354           165871
4  1984           227519 102823  124696   212844    14675           164116
5  1986           223275  97523  125752   207231    16044           162048
6  1988           239755 100561  139194   223250    16505           173672
# ... with 5 more variables: `4-year - Public` &lt;dbl&gt;, `2-year - Public` &lt;dbl&gt;,
#   `Total - Private` &lt;dbl&gt;, `4-year - Private` &lt;dbl&gt;, `2-year - Private` &lt;dbl&gt;</code></pre>
      <h1 id="data-wrangling-i">Data wrangling I</h1>
      <hr />
      <p>
        For the example plot, I focused on the enrollment between two genders
        from 1990 onwards. So we use the <code>dplyr</code> package to conduct a
        first data wrangling step, getting a small dataset which contains data
        on male and female enrollments per year and the numeric difference
        between them.
      </p>
      <div class="sourceCode" id="cb6">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>hbcu_all <span class="op">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1990</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#filter the year</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span><span class="kw">select</span>(Year, Males, Females)<span class="op">%&gt;%</span><span class="st"> </span><span class="co">#select columns of interest</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">diff =</span> Females <span class="op">-</span><span class="st"> </span>Males) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#calculate difference</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(Males, Females)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#get into long format</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">Gender =</span> name, <span class="co">#rename columns</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>         <span class="dt">Enrollments =</span> value)-&gt;<span class="st"> </span>dat_gender</span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="kw">head</span>(dat_gender)</span></code></pre>
      </div>
      <div data-pagedtable="false">
        <script data-pagedtable-source type="application/json">
          {
            "columns": [
              {
                "label": ["Year"],
                "name": [1],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["diff"],
                "name": [2],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Gender"],
                "name": [3],
                "type": ["chr"],
                "align": ["left"]
              },
              {
                "label": ["Enrollments"],
                "name": [4],
                "type": ["dbl"],
                "align": ["right"]
              }
            ],
            "data": [
              { "1": "1990", "2": "46838", "3": "Males", "4": "105157" },
              { "1": "1990", "2": "46838", "3": "Females", "4": "151995" },
              { "1": "1991", "2": "48451", "3": "Males", "4": "110442" },
              { "1": "1991", "2": "48451", "3": "Females", "4": "158893" },
              { "1": "1992", "2": "50297", "3": "Males", "4": "114622" },
              { "1": "1992", "2": "50297", "3": "Females", "4": "164919" }
            ],
            "options": {
              "columns": { "min": {}, "max": [10] },
              "rows": { "min": [10], "max": [10] },
              "pages": {}
            }
          }
        </script>
      </div>
      <p>Console output:</p>
      <pre><code># A tibble: 6 x 4
   Year  diff Gender  Enrollments
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;
1  1990 46838 Males        105157
2  1990 46838 Females      151995
3  1991 48451 Males        110442
4  1991 48451 Females      158893
5  1992 50297 Males        114622
6  1992 50297 Females      164919</code></pre>
      <p>
        In order to plot the range between the two groups later on, we need two
        tibbles which are only holding the data of 1 gender each.
      </p>
      <div class="sourceCode" id="cb8">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>Males &lt;-<span class="st"> </span>dat_gender <span class="op">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;Males&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>Females &lt;-<span class="st"> </span>dat_gender <span class="op">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;Females&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="kw">head</span>(Females)</span></code></pre>
      </div>
      <div data-pagedtable="false">
        <script data-pagedtable-source type="application/json">
          {
            "columns": [
              {
                "label": ["Year"],
                "name": [1],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["diff"],
                "name": [2],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Gender"],
                "name": [3],
                "type": ["chr"],
                "align": ["left"]
              },
              {
                "label": ["Enrollments"],
                "name": [4],
                "type": ["dbl"],
                "align": ["right"]
              }
            ],
            "data": [
              { "1": "1990", "2": "46838", "3": "Females", "4": "151995" },
              { "1": "1991", "2": "48451", "3": "Females", "4": "158893" },
              { "1": "1992", "2": "50297", "3": "Females", "4": "164919" },
              { "1": "1993", "2": "50062", "3": "Females", "4": "166459" },
              { "1": "1994", "2": "52059", "3": "Females", "4": "166065" },
              { "1": "1995", "2": "53451", "3": "Females", "4": "166088" }
            ],
            "options": {
              "columns": { "min": {}, "max": [10] },
              "rows": { "min": [10], "max": [10] },
              "pages": {}
            }
          }
        </script>
      </div>
      <p>Console output:</p>
      <pre><code># A tibble: 6 x 4
   Year  diff Gender  Enrollments
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;
1  1990 46838 Females      151995
2  1991 48451 Females      158893
3  1992 50297 Females      164919
4  1993 50062 Females      166459
5  1994 52059 Females      166065
6  1995 53451 Females      166088</code></pre>
      <p>This data is all we need to create a basic dummbell plot.</p>
      <h1 id="the-basic-dumbbell-plot">The basic dumbbell plot</h1>
      <hr />
      <p>
        Now we can use the <code>ggplot2</code> package to plot a basic dumbbell
        plot. The geoms that we are going to use are
        <code>geom_point()</code> for the groupwise points and
        <code>geom_segment()</code> to create a visible connection between the
        two group entries per year.
      </p>
      <div class="sourceCode" id="cb10">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dat_gender)<span class="op">+</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st"> </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> Males,</span>
<span id="cb10-4"><a href="#cb10-4"></a>              <span class="kw">aes</span>(<span class="dt">x =</span> Enrollments, <span class="dt">y =</span> Year,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                  <span class="dt">yend =</span> Females<span class="op">$</span>Year, <span class="dt">xend =</span> Females<span class="op">$</span>Enrollments), <span class="co">#use the $ operator to fetch data from our &quot;Females&quot; tibble</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>              <span class="dt">color =</span> <span class="st">&quot;#aeb6bf&quot;</span>,</span>
<span id="cb10-7"><a href="#cb10-7"></a>              <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="co">#Note that I sized the segment to fit the points</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>              <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="st">  </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Enrollments, <span class="dt">y =</span> Year, <span class="dt">color =</span> Gender), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">show.legend =</span> <span class="ot">TRUE</span>)<span class="op">+</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="st">  </span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="kw">ggtitle</span>(<span class="st">&quot;Enrollment Trends at Historically Black Colleges and Universities&quot;</span>)</span>
<span id="cb10-13"><a href="#cb10-13"></a>p</span></code></pre>
      </div>
      <p>
        <img
          src="web-extended-dumbbell-plot-ggplot2_files/figure-html/unnamed-chunk-7-1.png"
          width="768"
        />
      </p>
      <h1 id="data-wrangling-ii-for-extension">
        Data wrangling II for extension
      </h1>
      <hr />
      <p>
        To plot the extended version of this viz, we need to add the labels on
        the range and the line and shading for mean and standard deviation per
        group. So first, we further wrangle the data to calculate the mean +/- 1
        standard deviation per group over all years and then create 2 separate
        tibbles, 1 for each group.
      </p>
      <div class="sourceCode" id="cb11">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>dat_gender <span class="op">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">group_by</span>(Gender) <span class="op">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Enrollments),</span>
<span id="cb11-4"><a href="#cb11-4"></a>            <span class="dt">SE =</span> <span class="kw">sd</span>(Enrollments)) <span class="op">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">meanpos =</span> mean <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">*</span>SE,</span>
<span id="cb11-6"><a href="#cb11-6"></a>         <span class="dt">meanneg =</span> mean <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="op">*</span>SE)-&gt;<span class="st"> </span>stats</span>
<span id="cb11-7"><a href="#cb11-7"></a>stats_males &lt;-<span class="st"> </span>stats <span class="op">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;Males&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9"></a>stats_females &lt;-<span class="st"> </span>stats <span class="op">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;Females&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="kw">head</span>(stats)</span></code></pre>
      </div>
      <div data-pagedtable="false">
        <script data-pagedtable-source type="application/json">
          {
            "columns": [
              {
                "label": ["Gender"],
                "name": [1],
                "type": ["chr"],
                "align": ["left"]
              },
              {
                "label": ["mean"],
                "name": [2],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["SE"],
                "name": [3],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["meanpos"],
                "name": [4],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["meanneg"],
                "name": [5],
                "type": ["dbl"],
                "align": ["right"]
              }
            ],
            "data": [
              {
                "1": "Females",
                "2": "177866.2",
                "3": "13907.970",
                "4": "191774.2",
                "5": "163958.3"
              },
              {
                "1": "Males",
                "2": "115788.9",
                "3": "6064.846",
                "4": "121853.7",
                "5": "109724.0"
              }
            ],
            "options": {
              "columns": { "min": {}, "max": [10] },
              "rows": { "min": [10], "max": [10] },
              "pages": {}
            }
          }
        </script>
      </div>
      <p>Console output:</p>
      <pre><code># A tibble: 2 x 5
  Gender     mean     SE meanpos meanneg
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 Females 177866. 13908. 191774. 163958.
2 Males   115789.  6065. 121854. 109724.</code></pre>
      <p>
        As for the labels on the range, we need a tibble that holds the
        difference between the groups per year and a column indicating the
        position of the label.
      </p>
      <div class="sourceCode" id="cb13">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>diff &lt;-<span class="st"> </span>dat_gender <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw">filter</span>(Gender <span class="op">==</span><span class="st"> &quot;Males&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#you can chose Males of Females, doesn&#39;t matter</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x_pos =</span> Enrollments <span class="op">+</span><span class="st"> </span>(diff<span class="op">/</span><span class="dv">2</span>)) <span class="co">#x position of label (Enrollment value of Males + diff/2)</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">head</span>(diff)</span></code></pre>
      </div>
      <div data-pagedtable="false">
        <script data-pagedtable-source type="application/json">
          {
            "columns": [
              {
                "label": ["Year"],
                "name": [1],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["diff"],
                "name": [2],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["Gender"],
                "name": [3],
                "type": ["chr"],
                "align": ["left"]
              },
              {
                "label": ["Enrollments"],
                "name": [4],
                "type": ["dbl"],
                "align": ["right"]
              },
              {
                "label": ["x_pos"],
                "name": [5],
                "type": ["dbl"],
                "align": ["right"]
              }
            ],
            "data": [
              {
                "1": "1990",
                "2": "46838",
                "3": "Males",
                "4": "105157",
                "5": "128576.0"
              },
              {
                "1": "1991",
                "2": "48451",
                "3": "Males",
                "4": "110442",
                "5": "134667.5"
              },
              {
                "1": "1992",
                "2": "50297",
                "3": "Males",
                "4": "114622",
                "5": "139770.5"
              },
              {
                "1": "1993",
                "2": "50062",
                "3": "Males",
                "4": "116397",
                "5": "141428.0"
              },
              {
                "1": "1994",
                "2": "52059",
                "3": "Males",
                "4": "114006",
                "5": "140035.5"
              },
              {
                "1": "1995",
                "2": "53451",
                "3": "Males",
                "4": "112637",
                "5": "139362.5"
              }
            ],
            "options": {
              "columns": { "min": {}, "max": [10] },
              "rows": { "min": [10], "max": [10] },
              "pages": {}
            }
          }
        </script>
      </div>
      <p>Console output:</p>
      <pre><code># A tibble: 6 x 5
   Year  diff Gender Enrollments   x_pos
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
1  1990 46838 Males       105157 128576
2  1991 48451 Males       110442 134668.
3  1992 50297 Males       114622 139770.
4  1993 50062 Males       116397 141428
5  1994 52059 Males       114006 140036.
6  1995 53451 Males       112637 139362.</code></pre>
      <p>
        Iâ€™m pretty sure that the data wrangling can be improved at this point,
        so feel free to create a pull request in my github repository if you
        feel like contributing.
      </p>
      <h1 id="building-up-the-extension">Building up the extension</h1>
      <hr />
      <h2 id="add-labels-on-point-range">Add labels on point range</h2>
      <p>
        In a first step, we add the labels on the ranges using our
        <code>diff</code> tibble and <code>geom_text()</code>.
      </p>
      <div class="sourceCode" id="cb15">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">   </span><span class="kw">geom_text</span>(<span class="dt">data =</span> diff,</span>
<span id="cb15-3"><a href="#cb15-3"></a>             <span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;D: &quot;</span>,diff), <span class="dt">x =</span> x_pos, <span class="dt">y =</span> Year), <span class="co">#note thatI changed the greek letter Delta to &quot;D:&quot; because of encoding reasons</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>             <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>             <span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>,</span>
<span id="cb15-6"><a href="#cb15-6"></a>             <span class="dt">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>             <span class="dt">family =</span> <span class="st">&quot;Segoe UI Semibold&quot;</span>) -&gt;<span class="st"> </span>p_labelled</span>
<span id="cb15-8"><a href="#cb15-8"></a>p_labelled</span></code></pre>
      </div>
      <p>
        <img
          src="web-extended-dumbbell-plot-ggplot2_files/figure-html/unnamed-chunk-10-1.png"
          width="768"
        />
      </p>
      <h2 id="add-facet-theme">Add facet &amp; theme</h2>
      <p>
        To have more control over the spacing between the line-ranges we add a
        <code>facet</code> on the y axis. Since this will look horrible, we add
        some <code>theme()</code> specifications to set the angle of the facet
        strip texts and add some styling.
      </p>
      <div class="sourceCode" id="cb16">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>p_labelled <span class="op">+</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">  </span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="co">#add facet for more control</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">facet_grid</span>(Year <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="st">  </span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st">  </span><span class="co">#theming</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-9"><a href="#cb16-9"></a>        <span class="dt">panel.grid.minor.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-10"><a href="#cb16-10"></a>        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-11"><a href="#cb16-11"></a>        <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-12"><a href="#cb16-12"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-13"><a href="#cb16-13"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-14"><a href="#cb16-14"></a>        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb16-15"><a href="#cb16-15"></a>        <span class="dt">axis.ticks.x =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>),</span>
<span id="cb16-16"><a href="#cb16-16"></a>        <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Segoe UI Semibold&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>),</span>
<span id="cb16-17"><a href="#cb16-17"></a>        <span class="dt">strip.text.y.left  =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>),</span>
<span id="cb16-18"><a href="#cb16-18"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb16-19"><a href="#cb16-19"></a>        <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb16-20"><a href="#cb16-20"></a>        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>),</span>
<span id="cb16-21"><a href="#cb16-21"></a>        <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb16-22"><a href="#cb16-22"></a>        <span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb16-23"><a href="#cb16-23"></a>        <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">5</span>,<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>))-&gt;<span class="st"> </span>p_ext_facetted</span>
<span id="cb16-24"><a href="#cb16-24"></a>p_ext_facetted</span></code></pre>
      </div>
      <p>
        <img
          src="web-extended-dumbbell-plot-ggplot2_files/figure-html/unnamed-chunk-11-1.png"
          width="864"
        />
      </p>
      <p>
        Next, we place two small text annotations for mean and standard
        deviation so the reader knows what this is about. In the same step, we
        can define the point colors with `<code>scale_color_manual()</code>. We
        add the mean and standard deviation per gender group using
        <code>geom_vline()</code> and <code>geom_rect()</code> We add this
        <strong>before</strong> the rest of the plot because we want the
        point-ranges to be on top of it. We also add 2 text annotations for mean
        and standard deviations with <code>annotate()</code>.
      </p>
      <h2 id="add-mean-and-standard-deviation">
        Add mean and standard deviation
      </h2>
      <div class="sourceCode" id="cb17">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">ggplot</span>(dat_gender)<span class="op">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">  </span><span class="co">#add mean and standard deviation for both groups</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> stats_males<span class="op">$</span>meanneg, <span class="dt">xmax =</span> stats_males<span class="op">$</span>meanpos,</span>
<span id="cb17-5"><a href="#cb17-5"></a>            <span class="dt">ymin =</span> <span class="dv">2016</span>, <span class="dt">ymax =</span> <span class="dv">1989</span>, <span class="dt">fill =</span> <span class="st">&quot;#762a83&quot;</span>, <span class="dt">alpha =</span> <span class="fl">.05</span>)<span class="op">+</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> stats_males<span class="op">$</span>mean, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">alpha =</span> <span class="fl">.8</span>, <span class="dt">color =</span> <span class="st">&quot;#762a83&quot;</span>)<span class="op">+</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="st">  </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">xmin =</span> stats_females<span class="op">$</span>meanneg, <span class="dt">xmax =</span> stats_females<span class="op">$</span>meanpos,</span>
<span id="cb17-9"><a href="#cb17-9"></a>            <span class="dt">ymin =</span> <span class="dv">2016</span>, <span class="dt">ymax =</span> <span class="dv">1989</span>, <span class="dt">fill =</span> <span class="st">&quot;#009688&quot;</span>, <span class="dt">alpha =</span> <span class="fl">.05</span>)<span class="op">+</span><span class="st">  </span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> stats_females<span class="op">$</span>mean, <span class="dt">color =</span> <span class="st">&quot;#009688&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,  <span class="dt">size =</span> <span class="fl">.5</span>, <span class="dt">alpha =</span> <span class="fl">.8</span>) <span class="op">+</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="st">  </span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="st">  </span><span class="co">#add point range</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> Males, <span class="kw">aes</span>(<span class="dt">x =</span> Enrollments, <span class="dt">y =</span> Year, <span class="dt">yend =</span> Females<span class="op">$</span>Year, , <span class="dt">xend =</span> Females<span class="op">$</span>Enrollments),</span>
<span id="cb17-14"><a href="#cb17-14"></a>               <span class="dt">color =</span> <span class="st">&quot;#aeb6bf&quot;</span>, <span class="dt">size =</span> <span class="fl">4.5</span>, <span class="dt">alpha =</span> <span class="fl">.5</span>) <span class="op">+</span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="st">  </span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="st">  </span><span class="co">#add points</span></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Enrollments, <span class="dt">y =</span> Year, <span class="dt">color =</span> Gender), <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="st">  </span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="st">  </span><span class="co">#color points</span></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;#009688&quot;</span>,<span class="st">&quot;#762a83&quot;</span>))<span class="op">+</span></span>
<span id="cb17-21"><a href="#cb17-21"></a><span class="st">  </span><span class="co">#add point-range labels</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> diff, <span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">paste</span>(<span class="st">&quot;D: &quot;</span>,diff), <span class="dt">x =</span> x_pos, <span class="dt">y =</span> Year), <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>, <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>) <span class="op">+</span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="st">  </span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="st">  </span><span class="co">#add annotations for mean and standard deviations</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> stats_females<span class="op">$</span>mean <span class="op">-</span><span class="st"> </span><span class="dv">1500</span>, <span class="dt">y =</span> <span class="dv">1990</span>, <span class="dt">label =</span> <span class="st">&quot;MEAN&quot;</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">color =</span> <span class="st">&quot;#009688&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>)<span class="op">+</span></span>
<span id="cb17-26"><a href="#cb17-26"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">x =</span> stats_females<span class="op">$</span>meanpos <span class="dv">-1500</span>, <span class="dt">y =</span> <span class="dv">1990</span>, <span class="dt">label =</span> <span class="st">&quot;STDEV&quot;</span>, <span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">size =</span> <span class="fl">2.5</span>, <span class="dt">color =</span> <span class="st">&quot;#009688&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>)<span class="op">+</span></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="st">  </span></span>
<span id="cb17-28"><a href="#cb17-28"></a><span class="st">  </span><span class="co">#add facets for more control</span></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="st">  </span><span class="kw">facet_grid</span>(Year <span class="op">~</span><span class="st"> </span>., <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">switch =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></span>
<span id="cb17-30"><a href="#cb17-30"></a><span class="st">  </span><span class="co">#add title</span></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Enrollment Trends at Historically Black Colleges and Universities&quot;</span>)<span class="op">+</span></span>
<span id="cb17-32"><a href="#cb17-32"></a><span class="st">  </span><span class="co">#theming</span></span>
<span id="cb17-33"><a href="#cb17-33"></a><span class="st">  </span><span class="kw">theme_minimal</span>()<span class="op">+</span></span>
<span id="cb17-34"><a href="#cb17-34"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-35"><a href="#cb17-35"></a>        <span class="dt">panel.grid.minor.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-36"><a href="#cb17-36"></a>        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-37"><a href="#cb17-37"></a>        <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-38"><a href="#cb17-38"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-39"><a href="#cb17-39"></a>        <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-40"><a href="#cb17-40"></a>        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb17-41"><a href="#cb17-41"></a>        <span class="dt">axis.ticks.x =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>),</span>
<span id="cb17-42"><a href="#cb17-42"></a>        <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>),</span>
<span id="cb17-43"><a href="#cb17-43"></a>        <span class="dt">strip.text.y.left  =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">0</span>),</span>
<span id="cb17-44"><a href="#cb17-44"></a>        <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb17-45"><a href="#cb17-45"></a>        <span class="dt">strip.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb17-46"><a href="#cb17-46"></a>        <span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">&quot;#4a4e4d&quot;</span>, <span class="dt">family =</span> <span class="st">&quot;Segoe UI&quot;</span>),</span>
<span id="cb17-47"><a href="#cb17-47"></a>        <span class="dt">plot.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</span>
<span id="cb17-48"><a href="#cb17-48"></a>        <span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>, <span class="st">&quot;lines&quot;</span>),</span>
<span id="cb17-49"><a href="#cb17-49"></a>        <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">1</span>,<span class="dv">1</span>,.<span class="dv">5</span>,<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) -&gt;<span class="st"> </span>p_styled</span>
<span id="cb17-50"><a href="#cb17-50"></a>p_styled</span></code></pre>
      </div>
      <p>
        <img
          src="web-extended-dumbbell-plot-ggplot2_files/figure-html/unnamed-chunk-12-1.png"
          width="864"
        />
      </p>
      <h1 id="finish-plot-with-ggtext">Finish plot with <code>ggtext</code></h1>
      <hr />
      <p>
        In a final step we the subtitle and caption using
        <code>element_markdown()</code> from the <code>ggtext</code> package.
        This is the final code which will produce the extended dumbbell plot:
      </p>
      <div class="sourceCode" id="cb18">
        <pre
          class="sourceCode r"
        ><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>p_styled <span class="op">+</span><span class="st">   </span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">  </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="co">#add subtitle and caption</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;&lt;span style = &#39;color: #762a83;&#39;&gt;**Male**&lt;/span&gt; and &lt;span style = &#39;color: #009688;&#39;&gt;**Female**&lt;/span&gt; Enrollment from 1990 to 2015&lt;br&gt;&quot;</span>,</span>
<span id="cb18-5"><a href="#cb18-5"></a>       <span class="dt">caption =</span> <span class="st">&quot;Plot by **Tobias Stalder** | tobias-stalder.netlify.app&lt;br&gt;Data from **data.world** | data.world/nces | originally by NCES&lt;br&gt;**#TidyTuesday**&quot;</span>)<span class="op">+</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">  </span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="st">  </span><span class="co">#add theming for title, subtitle, caption</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.caption =</span> <span class="kw">element_markdown</span>(<span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">lineheight =</span> <span class="fl">1.5</span>),</span>
<span id="cb18-9"><a href="#cb18-9"></a>        <span class="dt">plot.subtitle =</span> <span class="kw">element_markdown</span>(<span class="dt">size =</span> <span class="dv">14</span>, <span class="dt">hjust =</span> <span class="fl">-.06</span>),</span>
<span id="cb18-10"><a href="#cb18-10"></a>        <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>, <span class="dt">hjust =</span> <span class="fl">-.14</span>)) -&gt;<span class="st"> </span>p_fin <span class="co">#Note that hjust of title and subtitle depend on the export dimensions</span></span>
<span id="cb18-11"><a href="#cb18-11"></a>p_fin</span></code></pre>
      </div>
      <p>
        <img
          src="web-extended-dumbbell-plot-ggplot2_files/figure-html/unnamed-chunk-13-1.png"
          width="864"
        />
        <!-- Close container -->
      </p>
    </div>
    <!-- ============================ RELATED SECTION ============================ -->
    <section
      class="bg-light"
      id="portfolio_landing"
      style="padding-top: 30px; padding-bottom: 30px; margin-top: 100px"
    >
      <div class="container">
        <p class="mySeryTitle">Related chart types</p>
        <hr />
        <div class="row">
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="line-plot.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Line150.png" alt="" />
            </a>
            <div class="captionPortfolio">Line plot</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="area-chart.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Area150.png" alt="" />
            </a>
            <div class="captionPortfolio">Area</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="stacked-area-graph.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img
                class="img-fluid"
                src="img/section/StackedArea150.png"
                alt=""
              />
            </a>
            <div class="captionPortfolio">Stacked area</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="streamgraph.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Stream150.png" alt="" />
            </a>
            <div class="captionPortfolio">Streamchart</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="time-series.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Time150.gif" alt="" />
            </a>
            <div class="captionPortfolio">Time Series</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ CONTACT SECTION ============================ -->
    <section
      id="contact"
      class="bg"
      style="background-color: white; padding-top: 60px"
    >
      <div class="container">
        <div class="row">
          <div class="col-lg-2 text-center"></div>
          <div class="col-lg-8 text-center">
            <br /><br /><br />
            <h2 class="section-heading text-uppercase" style="color: black">
              Contact
            </h2>
            <p>
              This document is a work by
              <a href="https://www.yan-holtz.com">Yan Holtz</a>. Any feedback is
              highly encouraged. You can fill an issue on
              <a href="https://github.com/holtzy/D3-graph-gallery/issues"
                >Github</a
              >, drop me a message on
              <a href="https://twitter.com/R_Graph_Gallery">Twitter</a>, or send
              an email pasting <a href="">yan.holtz.data</a> with
              <a href="">gmail.com</a>.
            </p>
            <div style="text-align: center">
              <a
                class="btn btn-primary btn-xl text-uppercase js-scroll-trigger"
                href="https://github.com/holtzy"
                >Github</a
              >
              <a
                class="btn btn-primary btn-xl text-uppercase js-scroll-trigger"
                href="https://twitter.com/R_Graph_Gallery"
                >Twitter</a
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ FOOTER SECTION ============================ -->
    <footer class="bg-light" id="myFooter">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <span class="copyright"
              >Copyright &copy; the R graph gallery 2018</span
            >
          </div>
          <div class="col-md-4">
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="https://twitter.com/R_Graph_Gallery">
                  <i class="fa fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://github.com/holtzy">
                  <i class="fa fa-github"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
                  <i class="fa fa-linkedin"></i>
                </a>
              </li>
            </ul>
          </div>
          <div class="col-md-4">
            <ul class="list-inline quicklinks">
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // add bootstrap table styles to pandoc tables
      function bootstrapStylePandocTables() {
        $("tr.header")
          .parent("thead")
          .parent("table")
          .addClass("table table-condensed");
      }
      $(document).ready(function () {
        bootstrapStylePandocTables();
      });
    </script>

    <!-- ============================ JAVASCRIPT SECTION ============================ -->

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/agency.min.js"></script>
  </body>
</html>
