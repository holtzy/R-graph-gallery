---
title: "topr"
descriptionMeta: "This post describes how to build a hexbin map, with input data available at geojson format. It provides a ste-by-step explanation and reproducible code."
descriptionTop: "The description that appears at the top of the page. You can include some `markdown` here!"
sectionText: "Hexbin map section"
#sectionLink: "hexbin-map.html"
DataToVizText: "Data to Viz"
#DataToVizLink: "data-to-viz.com/graph/hexbinmap.html"
url: "blog-post-template"
output:
  html_document:
      self_contained: false    
      mathjax: default
      lib_dir: libs
     # template: template_rgg.html
     # css: style.css
      toc: TRUE
      toc_float: TRUE
      toc_depth: 2
      df_print: "paged"
---


```{r global options, include = FALSE}
knitr::opts_chunk$set( warning=FALSE, message=FALSE)
```


#<div class="container">


# About
***

*topr* is a collection of plotting functions for visualizing and exploring genetic association results. Association results from multiple phenotypes can be viewed simultaneously, over the entire genome (Manhattan plot) or in the more detailed regional view.

*topr* utilises the <code>ggplot2</code> and <code>ggrepel</code> R graphics libraries for plotting.



For more details, see the *topr* [github page](https://github.com/totajuliusd/topr) and the *topr*  [publication](https://doi.org/10.1186/s12859-023-05301-4)

# Libraries
***

The *topr* package can be installed from CRAN using <code>install.packages("topr")</code>.

After installing the package it can be loaded as follows:

```{r}
library(tidyverse)
```


# Dataset
***

*topr* comes with three inbuilt datasets (<code>CD_UKBB, CD_FINNGEN</code> and <code>UC_UKBB</code>). These datasets were originally retrieved from the UK biobank and FinnGen respectivealy, and are association results (GWAS) on Crohn's disease (CD) and Ulcerative colitis (UC).

Input datasets must include least three columns (<code>CHROM, POS</code> and <code>P</code>), where naming of the columns is flexible (i.e the chr label can be either chr or chrom and is case insensitive). For more details, see [topr input datasets](https://totajuliusd.github.io/topr/articles/input_datasets.html)

# Basic plots
***

#<div class = "row">

#<div class = "col-md-6  col-sm-12 align-self-center">

*topr's*  two main plotting functions are <code>manhattan()</code> and <code>regionplot()</code>.

#</div>

Create a Manhattan plot using the <code>CD_UKBB</code> dataset>

#<div class = "col-md-6  col-sm-12">

```{r thecode, echo=FALSE, out.width = "100%", fig.height=4}
# The plot on the right. Code will appear below
manhattan(CD_UKBB)
```
#</div>
#</div>


```{r thecode, eval=FALSE}
```














# Layout: normal
***
You can also just write text followed by code followed by img

```{r}
plot(1,1)
```















<!-- Close container -->
</div>




```{r, echo=FALSE}
# This add some images at the end of the blogpost with related chart types
# You can choose: Map, Correlation, Flow, Other, Ranking, Evolution, PartOfWhole, Distribution
# htmltools::includeHTML("htmlChunkRelatedMap.html")
```
