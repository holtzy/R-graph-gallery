<!doctype html>
<html lang="en">
  <head>
    <!-- Google Analytics + AdThrive -->

    <!-- AdThrive Head Tag Manual -->
    <script data-no-optimize="1" data-cfasync="false">
      (function (w, d) {
        w.adthrive = w.adthrive || {};
        w.adthrive.cmd = w.adthrive.cmd || [];
        w.adthrive.plugin = "adthrive-ads-manual";
        w.adthrive.host = "ads.adthrive.com";
        var s = d.createElement("script");
        s.async = true;
        s.referrerpolicy = "no-referrer-when-downgrade";
        s.src =
          "https://" +
          w.adthrive.host +
          "/sites/6434363fc11d8059e61106b4/ads.min.js?referrer=" +
          w.encodeURIComponent(w.location.href) +
          "&cb=" +
          (Math.floor(Math.random() * 100) + 1);
        var n = d.getElementsByTagName("script")[0];
        n.parentNode.insertBefore(s, n);
      })(window, document);
    </script>
    <!-- End of AdThrive Head Tag -->

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-79254642-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-79254642-1");
    </script>

    <!-- Google Analytics + OutboundLink + Google Adsense -->

    <meta charset="utf-8" />
    <title>topr &#8211; the R Graph Gallery</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="description" content="This post describes how to use the
topr package for viewing and annotating genetic association results." />
    <meta
      name="keywords"
      content="R,ggplot2,tidyverse,Example,Data,Dataviz,Datavisualization,Plot,Chart,Graph,Learning,Caveat,Pitfall,Mistake"
    />
    <meta name="author" content="Yan Holtz" />
    <link rel="icon" href="img/logo/R_single_small.png" />

    <!-- Control appearance when shared by social media -->
    <meta property="og:title" content="topr" />
    <meta
      property="og:image"
      content="https://www.r-graph-gallery.com/img/overview_RGG.png"
    />
    <meta property="og:description" content="This post describes how to
use the topr package for viewing and annotating genetic association
results." />
    <meta
      property="og:url"
      content="https://www.r-graph-gallery.com/blog-post-template.html"
    />
    <meta property="og:type" content="website" />

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link
      href="vendor/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- Custom styles for this template -->
    <link href="css/agency.css" rel="stylesheet" />

    <!-- JQUERY -->
    <script src="vendor/jquery/jquery.min.js"></script>
  </head>

  <body data-spy="scroll" data-target="#myScrollspy" data-offset="1">
    <!-- THIS ALLOWS TO INSERT THE MENU THAT IS STORED IN A MENU.HTML FILE-->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav"></nav>
    <script>
      $(function () {
        $("#mainNav").load("html_chunk/menu.html");
      });
    </script>

    <!-- THIS ALLOWS TO INSERT THE MODAL OF THE MENU THAT IS STORED IN A MENU_MODAL.HTML FILE-->
    <div id="modal_menu_insertion"></div>
    <script>
      $(function () {
        $("#modal_menu_insertion").load("html_chunk/menu_modal.html");
      });
    </script>

    <!-- Header = Title in big + social media Icon + quick description -->
    <header class="masthead" style="padding-bottom: 30px">
      <div class="textlanding">
        <center><h1>topr</h1></center>
        <hr class="short_hr" />
        <br />
        <ul class="list-inline social-buttons">
          <li class="list-inline-item">
            <a href="https://twitter.com/R_Graph_Gallery">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://github.com/holtzy">
              <i class="fa fa-github" style="color: white"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.yan-holtz.com">
              <i class="fa fa-home"></i>
            </a>
          </li>
        </ul>
        <center>
          <p style="max-width: 600px; margin-top: 40px">A package for
viewing and annotating genetic association data</p>
        </center>
        <div style="text-align: center">
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="topr-package.html"
            >topr section</a
          >
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="https://www.data-to-viz.com/graph/web-topr-package.html"
            >Data to Viz</a
          >
        </div>
      </div>
    </header>

    <!-- THIS ALLOWS TO INSERT THE ADVERTISEMENT BANNER THAT IS STORED IN A BANNER.HTML FILE-->
    <div id="position_for_images"></div>
    <script>
      $(function () {
        $("#position_for_images").load("html_chunk/images.html");
      });
    </script>

    
    <!-- STYLE for chart pages but not the rest of tthe website -->
    <style>
      img {
        margin-top: 20px;
      }
    </style>

    <div class="container">
<div id="about" class="section level1">
<h1>About</h1>
<hr />
<div class="row">
<div class="col-md-8 col-sm-12 align-self-center">
<p><em>topr</em> is a collection of plotting functions for visualizing
and exploring genetic association results. Association results from
multiple phenotypes can be viewed simultaneously, over the entire genome
(Manhattan plot) or in the more detailed regional view.</p>
<p><em>topr</em> utilises the <code>ggplot2</code> and
<code>ggrepel</code> R graphics libraries for plotting.</p>
<p>For more details, see the <em>topr</em> <a
href="https://github.com/totajuliusd/topr">github page</a> and the
<em>topr</em> <a
href="https://doi.org/10.1186/s12859-023-05301-4">publication</a>.</p>
</div>
<div class="col-md-4 col-sm-12">
<p><img src="web-topr-package_files/figure-html/thecode-1.png" width="100%" /></p>
</div>
</div>
</div>
<div id="libraries" class="section level1">
<h1>Libraries</h1>
<hr />
<p>The <em>topr</em> package can be installed from CRAN using
<code>install.packages(“topr”)</code>.</p>
<p>After installing the package it can be loaded as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(topr)</span></code></pre></div>
</div>
<div id="dataset" class="section level1">
<h1>Dataset</h1>
<hr />
<p><em>topr</em> comes with three inbuilt genetic association datasets
(<code>CD_UKBB, CD_FINNGEN</code> and <code>UC_UKBB</code>). These
datasets were originally retrieved from the UK biobank and FinnGen, and
are association results (GWAS summary statistics) on Crohn’s disease
(CD) and Ulcerative colitis (UC).</p>
<p>Input datasets must include least three columns (<code>CHROM,
POS</code> and <code>P</code>), where naming of the columns is flexible
(i.e the chr label can be either chr or chrom and is case insensitive).
For more details, see <a
href="https://totajuliusd.github.io/topr/articles/input_datasets.html">topr
input datasets</a>.</p>
</div>
<div id="basic-usage" class="section level1">
<h1>Basic usage</h1>
<hr />
<p><em>topr’s</em> three main plotting functions are
<code>manhattan()</code>, <code>regionplot()</code> and
<code>locuszoom()</code>.</p>
<div id="manhattan" class="section level2">
<h2>manhattan</h2>
<hr />
<p>Create a Manhattan plot using the <code>CD_UKBB</code> dataset</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">manhattan</span>(CD_UKBB)</span></code></pre></div>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-2-1.png" width="816" /></p>
<p>Annotate the top variants (with p-values below 5e-9) with their
nearest gene:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">manhattan</span>(CD_UKBB, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>          <span class="at">annotate=</span><span class="fl">5e-9</span>)</span></code></pre></div>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-3-1.png" width="816" /></p>
<p>Show multiple datasets on the same plot using two y-axes and specify
how many datasets to show on the ‘top’ and on the ‘bottom’ with the
<code>ntop</code> argument.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">manhattan</span>(<span class="fu">list</span>(CD_UKBB, CD_FINNGEN), </span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>          <span class="at">legend_labels =</span> <span class="fu">c</span>(<span class="st">&quot;UKBB&quot;</span>, <span class="st">&quot;FinnGen&quot;</span>), </span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>          <span class="at">annotate=</span><span class="fl">1e-12</span>, <span class="at">ntop=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-4-1.png" width="816" /></p>
<p>See <a
href="https://totajuliusd.github.io/topr_manual/manhattan.html">manhattan</a>
for more detailed examples of how to use the manhattan plot
function.</p>
<p><br></p>
<div id="highlight-snps-of-interest" class="section level3">
<h3>Highlight SNPs of interest</h3>
<p>Extract snps within a specific region and show them in red on the
plot. Only annotate the snpsOfInterest.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>snpsOfInterest <span class="ot">&lt;-</span> <span class="fu">get_snps_within_region</span>(CD_UKBB, <span class="at">region=</span><span class="st">&quot;chr1:67038906-67359979&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">manhattan</span>(<span class="fu">list</span>(CD_UKBB, snpsOfInterest), <span class="at">color=</span><span class="fu">c</span>(<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;red&quot;</span>), </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>          <span class="at">legend_labels=</span><span class="fu">c</span>(<span class="st">&quot;CD UKBB&quot;</span>,<span class="st">&quot;SNPs of interest&quot;</span>), </span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>          <span class="at">annotate=</span><span class="fu">c</span>(<span class="fl">1e-100</span>, <span class="fl">1e-09</span>), </span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>          <span class="at">label_color=</span><span class="st">&quot;black&quot;</span>, </span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>          <span class="at">nudge_y=</span><span class="dv">2</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>          <span class="at">verbose=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-6-1.png" width="816" /></p>
<p>See <a
href="https://github.com/totajuliusd/topr?tab=readme-ov-file#how-to-color-specific-peaks-on-the-manhattan-plot">how-to-color-specific-peaks-on-the-manhattan-plot</a>
for more details.</p>
<p><br></p>
</div>
<div id="use-topr-with-other-species" class="section level3">
<h3>Use topr with other species</h3>
<p>By default topr uses the human genome assembly for annotation, it can
be used with different gene annotations as long as they are provided by
the user in a specific format, see <a
href="https://github.com/totajuliusd/topr?tab=readme-ov-file#how-to-use-topr-with-other-species-than-human">How
to use topr with other species than human</a>.</p>
<p><br></p>
</div>
</div>
<div id="regionplot" class="section level2">
<h2>regionplot</h2>
<hr />
<p>Displays association results for smaller genetic regions defined by
the gene name:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">regionplot</span>(CD_UKBB, </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>           <span class="at">gene=</span><span class="st">&quot;IL23R&quot;</span>, </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>           <span class="at">annotate=</span><span class="fl">5e-9</span>, </span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>           <span class="at">scale=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Zoomed to region:  1:67038907-67359979&quot;</code></pre>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-7-1.png" width="864" /></p>
<p>Annotate the variants with vline with reduced region size for denser
labelling of top snps.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">regionplot</span>(CD_UKBB, <span class="at">gene=</span><span class="st">&quot;IL23R&quot;</span>,</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>           <span class="at">annotate_with_vline=</span><span class="fl">5e-9</span>, </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>           <span class="at">region_size=</span><span class="dv">100000</span>, </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>           <span class="at">scale=</span><span class="fl">0.9</span>, )</span></code></pre></div>
<pre><code>## [1] &quot;Zoomed to region:  1:67038907-67359979&quot;</code></pre>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-8-1.png" width="864" /></p>
<p><br></p>
</div>
<div id="locuszoom" class="section level2">
<h2>locuszoom</h2>
<hr />
<p>View the correlation pattern between the variants within the region
in a locuszoom like plot.</p>
<p>Note that the variant correlation (<code>R2</code>) has to be
<strong>pre-calculated</strong> and included in the input dataset. If
the dataset does not contain pre-calculated correlation values, they can
be retrieved using the <code>LDproxy</code> package as described <a
href="https://github.com/totajuliusd/topr?tab=readme-ov-file#locuszoom-example">here</a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">locuszoom</span>(R2_CD_UKBB, <span class="at">scale=</span><span class="fl">0.9</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Zoomed to region:  1:67042284-67359988&quot;</code></pre>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-9-1.png" width="864" /></p>
<p><br></p>
</div>
<div id="manhattanextra" class="section level2">
<h2>manhattanExtra</h2>
<hr />
<p>Contribution from Kyle Scott <a
href="https://github.com/kscott-1">kscott-1</a></p>
<p>Create a Manhattan plot highlighting genome-wide significant and
suggestive loci using the manhattanExtra function.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">manhattanExtra</span>(UC_UKBB, </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>               <span class="at">flank_size =</span> <span class="fl">1e6</span>, </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>               <span class="at">region_size=</span><span class="fl">1e7</span>,</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>               <span class="at">scale=</span><span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="web-topr-package_files/figure-html/unnamed-chunk-10-1.png" width="816" /></p>
<!-- Close container -->
</div>
</div>
</div> 
    <!-- ============================ CONTACT SECTION ============================ -->
    <section
      id="contact"
      class="bg"
      style="background-color: white; padding-top: 60px"
    >
      <div class="container">
        <div class="row">
          <div class="col-lg-2 text-center"></div>
          <div class="col-lg-8 text-center">
            <br /><br /><br />
            <h2>❤️ 10 best R tricks ❤️</h2>
            <p style="max-width: 620px; text-align: center">
              👋 After crafting hundreds of R charts over 12 years, I've
              distilled my top 10 tips and tricks. Receive them via email!
              <b>One insight per day for the next 10 days</b>! 🔥
            </p>
            <div style="display: flex; justify-content: center">
              <script
                async
                data-uid="329fda5a7e"
                src="https://prodigious-trailblazer-3628.ck.page/329fda5a7e/index.js"
              ></script>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ FOOTER SECTION ============================ -->

    <!-- AdThrive Footer Code Start-->
    <script
      type="text/javascript"
      async
      src="https://btloader.com/tag?o=5698917485248512&upapi=true&domain=r-graph-gallery.com"
    ></script>
    <script>
      !(function () {
        "use strict";
        var e;
        (e = document),
          (function () {
            var t, n;
            function r() {
              var t = e.createElement("script");
              (t.src =
                "https://cafemedia-com.videoplayerhub.com/galleryplayer.js"),
                e.head.appendChild(t);
            }
            function a() {
              var t = e.cookie.match("(^|[^;]+)\s*__adblocker\s*=\s*([^;]+)");
              return t && t.pop();
            }
            function c() {
              clearInterval(n);
            }
            return {
              init: function () {
                var e;
                "true" === (t = a())
                  ? r()
                  : ((e = 0),
                    (n = setInterval(function () {
                      (100 !== e && "false" !== t) || c(),
                        "true" === t && (r(), c()),
                        (t = a()),
                        e++;
                    }, 50)));
              },
            };
          })().init();
      })();
    </script>
    <!-- AdThrive Footer Code End -->

    <footer class="bg-light" id="myFooter">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <span class="copyright"
              >Copyright &copy; the R graph gallery 2018</span
            >
          </div>
          <div class="col-md-4">
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="https://twitter.com/R_Graph_Gallery">
                  <i class="fa fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://github.com/holtzy">
                  <i class="fa fa-github"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
                  <i class="fa fa-linkedin"></i>
                </a>
              </li>
            </ul>
          </div>
          <div class="col-md-4">
            <ul class="list-inline quicklinks">
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script>

      // add bootstrap table styles to pandoc tables
      function bootstrapStylePandocTables() {
        $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
      }
      $(document).ready(function () {
        bootstrapStylePandocTables();
      });

          </script>

    
    <!-- ============================ JAVASCRIPT SECTION ============================ -->

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/agency.min.js"></script>
  </body>
</html>
