<!doctype html>
<html lang="en">
  <head>
    <!-- Google Analytics + AdThrive -->

    <!-- AdThrive Head Tag Manual -->
    <script data-no-optimize="1" data-cfasync="false">
      (function (w, d) {
        w.adthrive = w.adthrive || {};
        w.adthrive.cmd = w.adthrive.cmd || [];
        w.adthrive.plugin = "adthrive-ads-manual";
        w.adthrive.host = "ads.adthrive.com";
        var s = d.createElement("script");
        s.async = true;
        s.referrerpolicy = "no-referrer-when-downgrade";
        s.src =
          "https://" +
          w.adthrive.host +
          "/sites/6434363fc11d8059e61106b4/ads.min.js?referrer=" +
          w.encodeURIComponent(w.location.href) +
          "&cb=" +
          (Math.floor(Math.random() * 100) + 1);
        var n = d.getElementsByTagName("script")[0];
        n.parentNode.insertBefore(s, n);
      })(window, document);
    </script>
    <!-- End of AdThrive Head Tag -->

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=UA-79254642-1"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "UA-79254642-1");
    </script>

    <!-- Google Analytics + OutboundLink + Google Adsense -->

    <meta charset="utf-8" />
    <title>
      Jacques Bertin’s valued points map with R &#8211; the R Graph Gallery
    </title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta
      name="description"
      content="How to make a Bertin’s valued dots
map using R: full tutorial with code and explanation."
    />
    <meta
      name="keywords"
      content="R,ggplot2,tidyverse,Example,Data,Dataviz,Datavisualization,Plot,Chart,Graph,Learning,Caveat,Pitfall,Mistake"
    />
    <meta name="author" content="Yan Holtz" />
    <link rel="icon" href="img/logo/R_single_small.png" />

    <!-- Control appearance when shared by social media -->
    <meta
      property="og:title"
      content="Jacques Bertin’s valued points
map with R"
    />
    <meta
      property="og:image"
      content="https://www.r-graph-gallery.com/img/overview_RGG.png"
    />
    <meta
      property="og:description"
      content="How to make a Bertin’s
valued dots map using R: full tutorial with code and explanation."
    />
    <meta
      property="og:url"
      content="https://www.r-graph-gallery.com/web-valued-dots-map-bertin.html"
    />
    <meta property="og:type" content="website" />

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Custom fonts for this template -->
    <link
      href="vendor/font-awesome/css/font-awesome.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- Custom styles for this template -->
    <link href="css/agency.css" rel="stylesheet" />

    <!-- JQUERY -->
    <script src="vendor/jquery/jquery.min.js"></script>
  </head>

  <body data-spy="scroll" data-target="#myScrollspy" data-offset="1">
    <!-- THIS ALLOWS TO INSERT THE MENU THAT IS STORED IN A MENU.HTML FILE-->
    <nav class="navbar navbar-expand-lg fixed-top" id="mainNav"></nav>
    <script>
      $(function () {
        $("#mainNav").load("html_chunk/menu.html");
      });
    </script>

    <!-- THIS ALLOWS TO INSERT THE MODAL OF THE MENU THAT IS STORED IN A MENU_MODAL.HTML FILE-->
    <div id="modal_menu_insertion"></div>
    <script>
      $(function () {
        $("#modal_menu_insertion").load("html_chunk/menu_modal.html");
      });
    </script>

    <div id="modal_subscribe_insertion"></div>
    <script>
      $(function () {
        $("#modal_subscribe_insertion").load("html_chunk/subscribe_modal.html");
      });
    </script>

    <!-- Header = Title in big + social media Icon + quick description -->
    <header class="masthead" style="padding-bottom: 30px">
      <div class="textlanding">
        <center><h1>Jacques Bertin’s valued points map with R</h1></center>
        <hr class="short_hr" />
        <br />
        <ul class="list-inline social-buttons">
          <li class="list-inline-item">
            <a href="https://twitter.com/R_Graph_Gallery">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://github.com/holtzy">
              <i class="fa fa-github" style="color: white"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
              <i class="fa fa-linkedin"></i>
            </a>
          </li>
          <li class="list-inline-item social-buttons">
            <a href="https://www.yan-holtz.com">
              <i class="fa fa-home"></i>
            </a>
          </li>
        </ul>
        <center>
          <p style="max-width: 600px; margin-top: 40px">
            A _Bertin’s valued dots map__ is a specific type of thematic map
            where dots represent quantities and their values are depicted
            through various sizes or colors.<br />This tutorial explains how to
            build one using R, the
            <a
              href="https://www.productive-r-workflow.com/r/module1/tidyverse-is-your-friend"
              >tidyverse</a
            >
            and a couple of other packages.
          </p>
        </center>
        <div style="text-align: center">
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="bubble-map.html"
            >Bubble map Section</a
          >
          <a
            class="btn btn-secondary btn-xl text-uppercase js-scroll-trigger"
            href="https://www.data-to-viz.com/graph/bubblemap.html"
            >Data to Viz</a
          >
        </div>
      </div>
    </header>

    <!-- THIS ALLOWS TO INSERT THE ADVERTISEMENT BANNER THAT IS STORED IN A BANNER.HTML FILE-->
    <div id="position_for_images"></div>
    <script>
      $(function () {
        $("#position_for_images").load("html_chunk/images.html");
      });
    </script>

    <!-- STYLE for chart pages but not the rest of tthe website -->
    <style>
      img {
        margin-top: 20px;
      }
    </style>

    <div class="container" style="padding-top: 100px">
      <p>
        The goal of this tutorial is to show
        <strong
          >how to transform maps into valued points in the way of Jacques
          Bertin</strong
        >:<br />
      </p>
      <center>
        <img
          src="https://raw.githubusercontent.com/BjnNowak/Lessons/main/fig/R_2/bertin.png"
          alt="Bertin's map of population density in France"
          width="60%"
          height="auto"
        />
      </center>
      <p>
        <br />
        This tutorial will show you how to recreate a similar map of population
        density in France with R. Compared with Jacques Bertin’s work, we’ll be
        taking advantage of the new data available by starting from a raster
        (with population densities per pixel), whereas the original map was
        based on population densities per department (see map above).
      </p>
      <div id="load-data" class="section level1">
        <h1>1. Load data</h1>
        <hr />
        <p>
          To create our population density map in the way of Jacques Bertin, we
          will need the following packages:
        </p>
        <div class="sourceCode" id="cb1">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(terra)     <span class="co"># For raster population file</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(tidyterra) <span class="co"># To plot terra rasters with ggplot()</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(sf)        <span class="co"># For French department vector </span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(ggtext)    <span class="co"># To customize plot text</span></span></code></pre>
        </div>
        <p>
          For this tutorial, I uploaded a basemap of French departments and a
          raster of population density for France. Population density has been
          downloaded from the
          <a href="https://ghsl.jrc.ec.europa.eu/download.php?ds=pop"
            >Global Human Settlement Layer</a
          >. Data may loaded directy in R as shown below:
        </p>
        <div class="sourceCode" id="cb2">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># France map</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>fr <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">read_sf</span>(<span class="st">&#39;https://github.com/BjnNowak/bertin_tuto/raw/main/map/france_sport.gpkg&#39;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Population density in km2</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>pop <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">&#39;https://github.com/BjnNowak/bertin_tuto/raw/main/map/france_pop_l93_2.tif&#39;</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co"># Rename raster band to &quot;pop&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="fu">names</span>(pop) <span class="ot">&lt;-</span> <span class="st">&quot;pop&quot;</span></span></code></pre>
        </div>
        <p>
          France departments is a <strong>vector</strong> layer (sf object) that
          may be plotted with <strong>geom_sf()</strong>:
        </p>
        <div class="sourceCode" id="cb3">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(fr,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geom))</span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-3-1.png"
            width="672"
          />
        </p>
        <p>
          France population density is a <strong>raster</strong> layer
          (SpatRaster object) that may be plotted with
          <strong>geom_spatraster()</strong>:
        </p>
        <div class="sourceCode" id="cb4">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  tidyterra<span class="sc">::</span><span class="fu">geom_spatraster</span>(<span class="at">data=</span>pop)</span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-4-1.png"
            width="672"
          />
        </p>
        <p>
          On the map of population density, you can already see one of the
          problems we’ll have to deal with: a strong heterogeneity of population
          density between the Paris region and the rest of France. But we’ll
          come back to this later…
        </p>
      </div>
      <div id="data-preparation" class="section level1">
        <h1>2. Data preparation</h1>
        <hr />
        <p>We must first reduce the number of pixels in the raster.</p>
        <p>
          If you have applied the above code, you may have seen a message
          telling you that the raster has been compressed for the plot
          (limitation of the number of pixels displayed). Indeed, the number of
          pixels in the raster is relatively large:
        </p>
        <div class="sourceCode" id="cb5">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Take a look at raster dimensions: </span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">nrow</span>(pop) <span class="co"># Number of rows</span></span></code></pre>
        </div>
        <pre><code>## [1] 1066</code></pre>
        <div class="sourceCode" id="cb7">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">ncol</span>(pop) <span class="co"># Number of columns</span></span></code></pre>
        </div>
        <pre><code>## [1] 1148</code></pre>
        <p>
          <strong
            >A map with valued points will not be legible with such a large
            number of points</strong
          >. So, before converting pixels into points, we will degrade the
          resolution of the raster. A number of 100 points per side to be
          represented seems reasonable. Let’s calculate the aggregation factor
          corresponding to this resolution:
        </p>
        <div class="sourceCode" id="cb9">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Compute factor to reduce raster to 100 rows:</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>factor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">nrow</span>(pop)<span class="sc">/</span><span class="dv">100</span>)</span></code></pre>
        </div>
        <p>
          We can now degrade the resolution of the raster by the corresponding
          factor:
        </p>
        <div class="sourceCode" id="cb10">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Aggregate to 100 rows</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>pop_agg <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">aggregate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  pop, <span class="at">fact =</span> factor,</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">na_rm=</span>T</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Replace potential NAs by 0</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>pop_agg[<span class="fu">is.na</span>(pop_agg)] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre>
        </div>
        <p>
          Now that the raster is at the right resolution, we’re going to extract
          the centroid of each pixel. This is a two-step process:
        </p>
        <ul>
          <li><p>convert the raster to tibble;</p></li>
          <li><p>convert the tibble obtained into a point vector.</p></li>
        </ul>
        <div class="sourceCode" id="cb11">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># 1. Convert raster to tibble</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>pop_tib <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  pop_agg,</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">xy =</span> <span class="cn">TRUE</span>,               <span class="co"># Get centroid of each cell </span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># 2. Convert tibble to point vector (sf object)</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>sf_pop <span class="ot">&lt;-</span> pop_tib<span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>), <span class="co"># Columns with longitude/latitude </span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    <span class="at">crs=</span> <span class="dv">2154</span>            <span class="co"># Set CRS (here Lambert-93)</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>  )</span></code></pre>
        </div>
        <p>Let’s take a look to the resulting vector:</p>
        <div class="sourceCode" id="cb12">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># This is a sf object that may now be plotted with geom_sf() :</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">ggplot</span>(sf_pop)<span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>() </span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-9-1.png"
            width="960"
          />
        </p>
        <p>
          As you can see, we’ve also kept the points outside metropolitan
          France. In this case, this comes from replacing all null values with
          0. But, as we have a spatial object,
          <strong>this can easily be corrected by an intersection</strong>:
        </p>
        <div class="sourceCode" id="cb13">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Keep only points inside metropolitan France</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>sf_pop_metro <span class="ot">&lt;-</span> <span class="fu">st_intersection</span>(sf_pop, fr)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="fu">ggplot</span>(sf_pop_metro)<span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-10-1.png"
            width="960"
          />
        </p>
        <p>
          Almost there! When we first plotted the population density map as a
          raster, I told you that we’d be coming back to the problem of strong
          population disparities between the Paris region and the rest of the
          country. This will simply be done by creating population density
          classes (to ensure that the points in the Paris region are the only
          ones to emerge).
        </p>
        <div class="sourceCode" id="cb14">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Keep only points inside metropolitan France</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>sf_pop_metro <span class="ot">&lt;-</span> sf_pop_metro<span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dens=</span><span class="fu">case_when</span>(</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    pop<span class="sc">&lt;</span><span class="dv">20</span><span class="sc">~</span><span class="st">&quot;A&quot;</span>,</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    pop<span class="sc">&lt;</span><span class="dv">70</span><span class="sc">~</span><span class="st">&quot;B&quot;</span>,</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    pop<span class="sc">&lt;</span><span class="dv">140</span><span class="sc">~</span><span class="st">&quot;C&quot;</span>,</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    pop<span class="sc">&lt;</span><span class="dv">200</span><span class="sc">~</span><span class="st">&quot;D&quot;</span>,</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    <span class="cn">TRUE</span><span class="sc">~</span><span class="st">&quot;E&quot;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>  ))</span></code></pre>
        </div>
      </div>
      <div id="make-map" class="section level1">
        <h1>3. Make map!</h1>
        <hr />
        <p>
          We are now ready to plot the map. As you may have already guessed,
          we’re going to vary the size of the points using the density class
          attribute that we just created:
        </p>
        <div class="sourceCode" id="cb15">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="at">data=</span>sf_pop_metro,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">size=</span>dens,<span class="at">geometry=</span>geometry)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>),</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;&lt;20 inhabitants&quot;</span>,<span class="st">&quot;20 to 69&quot;</span>,<span class="st">&quot;70 to 139&quot;</span>,<span class="st">&quot;140 to 199&quot;</span>,<span class="st">&quot;≥200 inhabitants&quot;</span>)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>  )</span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-12-1.png"
            width="960"
          />
        </p>
        <p>
          Finally, several modifications can be made to improve the look of the
          map:
        </p>
        <div class="sourceCode" id="cb16">
          <pre
            class="sourceCode r"
          ><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="co"># Add base map with French departments</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>    fr,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geom),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>    <span class="at">color=</span><span class="st">&quot;black&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="at">fill=</span><span class="st">&quot;white&quot;</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  <span class="fu">geom_sf</span>(</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>    sf_pop_metro,</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">geometry=</span>geometry,<span class="at">size=</span>dens),</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>    <span class="co"># Use a point with a border AND a fill</span></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>    <span class="at">pch=</span><span class="dv">21</span>,<span class="at">color=</span><span class="st">&quot;white&quot;</span>,<span class="at">fill=</span><span class="st">&quot;black&quot;</span>,<span class="at">stroke=</span><span class="fl">0.05</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    <span class="at">values=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>,<span class="dv">3</span>),</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>    <span class="at">label=</span><span class="fu">c</span>(<span class="st">&quot;&lt;20 inhabitants&quot;</span>,<span class="st">&quot;20 to 69&quot;</span>,<span class="st">&quot;70 to 139&quot;</span>,<span class="st">&quot;140 to 199&quot;</span>,<span class="st">&quot;≥200 inhabitants&quot;</span>)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>  <span class="co"># Customize labels</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>    <span class="at">title=</span><span class="st">&quot;**Population density in France**&quot;</span>,</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>    <span class="at">subtitle=</span><span class="st">&quot;in the way of Jacques Bertin&quot;</span>,</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    <span class="at">size=</span><span class="st">&quot;**Population density**&lt;br&gt;&lt;span style=&#39;color:grey&#39;&gt;Inhabitants per km&lt;sup&gt;2&lt;/sup&gt;&lt;/span&gt;&quot;</span>,</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>    <span class="at">caption=</span><span class="st">&quot;**Data** GHSL **| Plot** @BjnNowak&quot;</span></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a>    <span class="at">plot.margin =</span> <span class="fu">margin</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a>    <span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&quot;white&quot;</span>,<span class="at">color=</span><span class="cn">NA</span>),</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_markdown</span>(),</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(),</span>
<span id="cb16-33"><a href="#cb16-33" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_markdown</span>(<span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb16-34"><a href="#cb16-34" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>,<span class="at">color=</span><span class="st">&quot;grey40&quot;</span>),</span>
<span id="cb16-35"><a href="#cb16-35" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_markdown</span>(<span class="at">color=</span><span class="st">&quot;grey20&quot;</span>,<span class="at">hjust=</span><span class="fl">0.5</span>)</span>
<span id="cb16-36"><a href="#cb16-36" tabindex="-1"></a>  )</span></code></pre>
        </div>
        <p>
          <img
            src="web-valued-dots-map-bertin_files/figure-html/unnamed-chunk-13-1.png"
            width="960"
          />
        </p>
        <p>
          If you are interested in further applications of this type of map, I
          have made
          <a href="https://github.com/BjnNowak/bertin">a R package</a> to easily
          transform vector or raster maps into valued points.
        </p>
        <p>
          <strong>Author</strong>
          <a href="https://twitter.com/BjnNowak">Benjamin Nowak</a> <br />
          <strong>Data</strong>
          <a href="https://ghsl.jrc.ec.europa.eu/download.php?ds=pop"
            >Global Human Settlement Layer</a
          >
        </p>
        <p><br /></p>
        <!-- Close container -->
      </div>
    </div>
    <!-- ============================ RELATED SECTION ============================ -->
    <section
      class="bg-light"
      id="portfolio_landing"
      style="padding-top: 30px; padding-bottom: 30px; margin-top: 100px"
    >
      <div class="container">
        <p class="mySeryTitle">Related chart types</p>
        <hr />
        <div class="row">
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="barplot.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Bar150.png" alt="" />
            </a>
            <div class="captionPortfolio">Barplot</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="spider-or-radar-chart.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Spider150.png" alt="" />
            </a>
            <div class="captionPortfolio">Spider / Radar</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="wordcloud.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img
                class="img-fluid"
                src="img/section/Wordcloud150.png"
                alt=""
              />
            </a>
            <div class="captionPortfolio">Wordcloud</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="parallel-plot.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img
                class="img-fluid"
                src="img/section/Parallel1150.png"
                alt=""
              />
            </a>
            <div class="captionPortfolio">Parallel</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="lollipop-plot.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img class="img-fluid" src="img/section/Lollipop150.png" alt="" />
            </a>
            <div class="captionPortfolio">Lollipop</div>
          </div>
          <div class="col-md-2 col-sm-4 portfolio-item">
            <a class="portfolio-link" href="circular-barplot.html">
              <div class="portfolio-hover">
                <div class="portfolio-hover-content">
                  <i class="fa fa-plus fa-3x"></i>
                </div>
              </div>
              <img
                class="img-fluid"
                src="img/section/CircularBarplot150.png"
                alt=""
              />
            </a>
            <div class="captionPortfolio">Circular Barplot</div>
          </div>
        </div>
      </div>
    </section>
    <!-- ============================ CONTACT SECTION ============================ -->
    <section
      id="contact"
      class="bg"
      style="background-color: white; padding-top: 60px"
    >
      <div class="container">
        <div class="row">
          <div class="col-lg-2 text-center"></div>
          <div class="col-lg-8 text-center">
            <br /><br /><br />
            <h2 class="section-heading text-uppercase" style="color: black">
              Contact
            </h2>
            <p>
              This document is a work by
              <a href="https://www.yan-holtz.com">Yan Holtz</a>. Any feedback is
              highly encouraged. You can fill an issue on
              <a href="https://github.com/holtzy/D3-graph-gallery/issues"
                >Github</a
              >, drop me a message on
              <a href="https://twitter.com/R_Graph_Gallery">Twitter</a>, or send
              an email pasting <a href="">yan.holtz.data</a> with
              <a href="">gmail.com</a>.
            </p>
            <div style="text-align: center">
              <a
                class="btn btn-primary btn-xl text-uppercase js-scroll-trigger"
                href="https://github.com/holtzy"
                >Github</a
              >
              <a
                class="btn btn-primary btn-xl text-uppercase js-scroll-trigger"
                href="https://twitter.com/R_Graph_Gallery"
                >Twitter</a
              >
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============================ FOOTER SECTION ============================ -->

    <!-- AdThrive Footer Code Start-->
    <script
      type="text/javascript"
      async
      src="https://btloader.com/tag?o=5698917485248512&upapi=true&domain=r-graph-gallery.com"
    ></script>
    <script>
      !(function () {
        "use strict";
        var e;
        (e = document),
          (function () {
            var t, n;
            function r() {
              var t = e.createElement("script");
              (t.src =
                "https://cafemedia-com.videoplayerhub.com/galleryplayer.js"),
                e.head.appendChild(t);
            }
            function a() {
              var t = e.cookie.match("(^|[^;]+)\s*__adblocker\s*=\s*([^;]+)");
              return t && t.pop();
            }
            function c() {
              clearInterval(n);
            }
            return {
              init: function () {
                var e;
                "true" === (t = a())
                  ? r()
                  : ((e = 0),
                    (n = setInterval(function () {
                      (100 !== e && "false" !== t) || c(),
                        "true" === t && (r(), c()),
                        (t = a()),
                        e++;
                    }, 50)));
              },
            };
          })().init();
      })();
    </script>
    <!-- AdThrive Footer Code End -->

    <footer class="bg-light" id="myFooter">
      <div class="container">
        <div class="row">
          <div class="col-md-4">
            <span class="copyright"
              >Copyright &copy; the R graph gallery 2018</span
            >
          </div>
          <div class="col-md-4">
            <ul class="list-inline social-buttons">
              <li class="list-inline-item">
                <a href="https://twitter.com/R_Graph_Gallery">
                  <i class="fa fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://github.com/holtzy">
                  <i class="fa fa-github"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="https://www.linkedin.com/in/yan-holtz-2477534a/">
                  <i class="fa fa-linkedin"></i>
                </a>
              </li>
            </ul>
          </div>
          <div class="col-md-4">
            <ul class="list-inline quicklinks">
              <li class="list-inline-item">
                <a href="#">Privacy Policy</a>
              </li>
              <li class="list-inline-item">
                <a href="#">Terms of Use</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <script>
      // add bootstrap table styles to pandoc tables
      function bootstrapStylePandocTables() {
        $("tr.header")
          .parent("thead")
          .parent("table")
          .addClass("table table-condensed");
      }
      $(document).ready(function () {
        bootstrapStylePandocTables();
      });
    </script>

    <!-- ============================ JAVASCRIPT SECTION ============================ -->

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/agency.min.js"></script>
  </body>
</html>
